{"version":3,"file":"odo-window-events.min.js","sources":["../src/window-events.js","../node_modules/throttleit/index.js","../node_modules/debounce/index.js"],"sourcesContent":["import throttle from 'throttleit';\nimport debounce from 'debounce';\n\nlet count = 0;\nfunction uniqueId() {\n  count += 1;\n  return `OdoWindowEvents${count}`;\n}\n\nfunction callEachWithArg(object, args) {\n  Object.keys(object).forEach((i) => {\n    object[i].call(null, args[0], args[1]);\n  });\n}\n\n/**\n * Retrieves the scroll offsets. This only works for the page scroll. For\n * scroll positions of an element, the `scrollTop` and `scrollLeft` properties\n * need to be used.\n * @return {{top: number, left: number}}\n */\nfunction getScrollPosition() {\n  return {\n    top: window.pageYOffset,\n    left: window.pageXOffset,\n  };\n}\n\n/**\n * Retrieve the dimensions of the viewable screen.\n * @return {{width: number, height: number}}\n */\nfunction getViewportSize() {\n  return {\n    width: window.innerWidth,\n    height: window.innerHeight,\n  };\n}\n\nfunction addCallback(object, fn) {\n  const id = uniqueId();\n  object[id] = fn;\n  return id;\n}\n\nconst WindowEvents = {\n\n  _scrollCallbacks: {},\n  _fastScrollCallbacks: {},\n  _resizeCallbacks: {},\n  _leadingResizeCallbacks: {},\n\n  _callbacks: {\n    resize() {\n      const viewport = getViewportSize();\n      callEachWithArg(WindowEvents._resizeCallbacks, [viewport.width, viewport.height]);\n    },\n\n    leadingResize() {\n      const viewport = getViewportSize();\n      callEachWithArg(WindowEvents._leadingResizeCallbacks, [viewport.width, viewport.height]);\n    },\n\n    scroll() {\n      const scroll = getScrollPosition();\n      callEachWithArg(WindowEvents._scrollCallbacks, [scroll.top, scroll.left]);\n    },\n\n    fastScroll() {\n      const scroll = getScrollPosition();\n      callEachWithArg(WindowEvents._fastScrollCallbacks, [scroll.top, scroll.left]);\n    },\n  },\n\n  Timing: {\n    DEBOUNCE_TIME: 500,\n    THROTTLE_TIME_DEFAULT: 500,\n    THROTTLE_TIME_FAST: 150,\n  },\n\n  /**\n   * Bind a callback to window scroll.\n   * @param {function} fn Callback to execute on scroll.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onScroll(fn) {\n    return addCallback(WindowEvents._scrollCallbacks, fn);\n  },\n\n  /**\n   * Bind a callback to window scroll which executes quicker.\n   * @param {function} fn Callback to execute on scroll.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onFastScroll(fn) {\n    return addCallback(WindowEvents._fastScrollCallbacks, fn);\n  },\n\n  /**\n   * Bind a callback to window resize.\n   * @param {function} fn Callback to execute on resize.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onResize(fn) {\n    return addCallback(WindowEvents._resizeCallbacks, fn);\n  },\n\n  /**\n   * Bind a callback to window resize.\n   * @param {function} fn Callback to execute on resize.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onLeadingResize(fn) {\n    return addCallback(WindowEvents._leadingResizeCallbacks, fn);\n  },\n\n  /**\n   * Remove callback with a given id.\n   * @param {string} id Callback ID to remove.\n   */\n  remove(id) {\n    delete WindowEvents._scrollCallbacks[id];\n    delete WindowEvents._fastScrollCallbacks[id];\n    delete WindowEvents._resizeCallbacks[id];\n    delete WindowEvents._leadingResizeCallbacks[id];\n  },\n};\n\nconst resize = debounce(\n  WindowEvents._callbacks.resize,\n  WindowEvents.Timing.DEBOUNCE_TIME,\n);\nconst leadingResize = debounce(\n  WindowEvents._callbacks.leadingResize,\n  WindowEvents.Timing.DEBOUNCE_TIME, true,\n);\nconst scrolled = throttle(\n  WindowEvents._callbacks.scroll,\n  WindowEvents.Timing.THROTTLE_TIME_DEFAULT,\n);\nconst fastScroll = throttle(\n  WindowEvents._callbacks.fastScroll,\n  WindowEvents.Timing.THROTTLE_TIME_FAST,\n);\n\nWindowEvents._resizeCallback = () => {\n  leadingResize();\n  resize();\n};\n\nWindowEvents._scrollCallback = () => {\n  scrolled();\n  fastScroll();\n};\n\nwindow.addEventListener('resize', WindowEvents._resizeCallback);\nwindow.addEventListener('scroll', WindowEvents._scrollCallback);\n\nexport default WindowEvents;\n","module.exports = throttle;\n\n/**\n * Returns a new function that, when invoked, invokes `func` at most once per `wait` milliseconds.\n *\n * @param {Function} func Function to wrap.\n * @param {Number} wait Number of milliseconds that must elapse between `func` invocations.\n * @return {Function} A new function that wraps the `func` function passed in.\n */\n\nfunction throttle (func, wait) {\n  var ctx, args, rtn, timeoutID; // caching\n  var last = 0;\n\n  return function throttled () {\n    ctx = this;\n    args = arguments;\n    var delta = new Date() - last;\n    if (!timeoutID)\n      if (delta >= wait) call();\n      else timeoutID = setTimeout(call, wait - delta);\n    return rtn;\n  };\n\n  function call () {\n    timeoutID = 0;\n    last = +new Date();\n    rtn = func.apply(ctx, args);\n    ctx = null;\n    args = null;\n  }\n}\n","/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear' \n * that is a function which will clear the timer to prevent previously scheduled executions. \n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\n\nmodule.exports = function debounce(func, wait, immediate){\n  var timeout, args, context, timestamp, result;\n  if (null == wait) wait = 100;\n\n  function later() {\n    var last = Date.now() - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    }\n  };\n\n  var debounced = function(){\n    context = this;\n    args = arguments;\n    timestamp = Date.now();\n    var callNow = immediate && !timeout;\n    if (!timeout) timeout = setTimeout(later, wait);\n    if (callNow) {\n      result = func.apply(context, args);\n      context = args = null;\n    }\n\n    return result;\n  };\n\n  debounced.clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n\n  return debounced;\n};\n"],"names":["uniqueId","callEachWithArg","object","args","keys","forEach","i","call","getScrollPosition","window","pageYOffset","pageXOffset","getViewportSize","innerWidth","innerHeight","addCallback","fn","id","func","wait","Date","apply","ctx","rtn","timeoutID","last","this","arguments","delta","setTimeout","immediate","later","now","timestamp","context","timeout","result","debounced","callNow","clear","count","WindowEvents","viewport","_resizeCallbacks","width","height","_leadingResizeCallbacks","scroll","_scrollCallbacks","top","left","_fastScrollCallbacks","resize","debounce","_callbacks","Timing","DEBOUNCE_TIME","leadingResize","scrolled","throttle","THROTTLE_TIME_DEFAULT","fastScroll","THROTTLE_TIME_FAST","_resizeCallback","_scrollCallback","addEventListener"],"mappings":"2LAIA,SAASA,gCACE,GAIX,SAASC,EAAgBC,EAAQC,UACxBC,KAAKF,GAAQG,QAAQ,SAACC,KACpBA,GAAGC,KAAK,KAAMJ,EAAK,GAAIA,EAAK,MAUvC,SAASK,eAEAC,OAAOC,iBACND,OAAOE,aAQjB,SAASC,iBAEEH,OAAOI,kBACNJ,OAAOK,aAInB,SAASC,EAAYb,EAAQc,OACrBC,EAAKjB,aACJiB,GAAMD,EACNC,EC1CT,MAUA,SAAmBC,EAAMC,YAcdZ,MACK,KACJ,IAAIa,OACNF,EAAKG,MAAMC,EAAKnB,KAChB,OACC,SAlBLmB,EAAKnB,EAAMoB,EAAKC,EAChBC,EAAO,SAEJ,aACCC,OACCC,cACHC,EAAQ,IAAIR,KAASK,SACpBD,IACCI,GAAST,EAAMZ,IACdiB,EAAYK,WAAWtB,EAAMY,EAAOS,IACpCL,MCNM,SAAkBL,EAAMC,EAAMW,YAIpCC,QACHN,EAAOL,KAAKY,MAAQC,EAEpBR,EAAON,GAAQM,GAAQ,IACfI,WAAWE,EAAOZ,EAAOM,MAEzB,KACLK,MACMZ,EAAKG,MAAMa,EAAS/B,KACnBA,EAAO,WAZnBgC,EAAShC,EAAM+B,EAASD,EAAWG,EACnC,MAAQjB,IAAMA,EAAO,SAgBrBkB,EAAY,aACJX,OACHC,YACKP,KAAKY,UACbM,EAAUR,IAAcK,SACvBA,IAASA,EAAUN,WAAWE,EAAOZ,IACtCmB,MACOpB,EAAKG,MAAMa,EAAS/B,KACnBA,EAAO,MAGZiC,YAGCG,MAAQ,WACZJ,iBACWA,KACH,OAIPE,GFnDLG,EAAQ,EA0CNC,gIASMC,EAAW9B,MACD6B,EAAaE,kBAAmBD,EAASE,MAAOF,EAASG,uCAInEH,EAAW9B,MACD6B,EAAaK,yBAA0BJ,EAASE,MAAOF,EAASG,gCAI1EE,EAASvC,MACCiC,EAAaO,kBAAmBD,EAAOE,IAAKF,EAAOG,kCAI7DH,EAASvC,MACCiC,EAAaU,sBAAuBJ,EAAOE,IAAKF,EAAOG,+BAK1D,0BACQ,uBACH,uBAQblC,UACAD,EAAY0B,EAAaO,iBAAkBhC,0BAQvCA,UACJD,EAAY0B,EAAaU,qBAAsBnC,sBAQ/CA,UACAD,EAAY0B,EAAaE,iBAAkB3B,6BAQpCA,UACPD,EAAY0B,EAAaK,wBAAyB9B,oBAOpDC,UACEwB,EAAaO,iBAAiB/B,UAC9BwB,EAAaU,qBAAqBlC,UAClCwB,EAAaE,iBAAiB1B,UAC9BwB,EAAaK,wBAAwB7B,KAI1CmC,EAASC,EACbZ,EAAaa,WAAWF,OACxBX,EAAac,OAAOC,eAEhBC,EAAgBJ,EACpBZ,EAAaa,WAAWG,cACxBhB,EAAac,OAAOC,eAAe,GAE/BE,EAAWC,EACflB,EAAaa,WAAWP,OACxBN,EAAac,OAAOK,uBAEhBC,EAAaF,EACjBlB,EAAaa,WAAWO,WACxBpB,EAAac,OAAOO,2BAGtBrB,EAAasB,gBAAkB,oBAK/BtB,EAAauB,gBAAkB,oBAK/BvD,OAAOwD,iBAAiB,SAAUxB,EAAasB,iBAC/CtD,OAAOwD,iBAAiB,SAAUxB,EAAauB"}