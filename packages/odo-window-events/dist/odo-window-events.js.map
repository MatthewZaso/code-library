{"version":3,"file":"odo-window-events.js","sources":["../node_modules/throttleit/index.js","../node_modules/debounce/index.js","../src/window-events.js"],"sourcesContent":["module.exports = throttle;\n\n/**\n * Returns a new function that, when invoked, invokes `func` at most once per `wait` milliseconds.\n *\n * @param {Function} func Function to wrap.\n * @param {Number} wait Number of milliseconds that must elapse between `func` invocations.\n * @return {Function} A new function that wraps the `func` function passed in.\n */\n\nfunction throttle (func, wait) {\n  var ctx, args, rtn, timeoutID; // caching\n  var last = 0;\n\n  return function throttled () {\n    ctx = this;\n    args = arguments;\n    var delta = new Date() - last;\n    if (!timeoutID)\n      if (delta >= wait) call();\n      else timeoutID = setTimeout(call, wait - delta);\n    return rtn;\n  };\n\n  function call () {\n    timeoutID = 0;\n    last = +new Date();\n    rtn = func.apply(ctx, args);\n    ctx = null;\n    args = null;\n  }\n}\n","/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear' \n * that is a function which will clear the timer to prevent previously scheduled executions. \n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\n\nmodule.exports = function debounce(func, wait, immediate){\n  var timeout, args, context, timestamp, result;\n  if (null == wait) wait = 100;\n\n  function later() {\n    var last = Date.now() - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    }\n  };\n\n  var debounced = function(){\n    context = this;\n    args = arguments;\n    timestamp = Date.now();\n    var callNow = immediate && !timeout;\n    if (!timeout) timeout = setTimeout(later, wait);\n    if (callNow) {\n      result = func.apply(context, args);\n      context = args = null;\n    }\n\n    return result;\n  };\n\n  debounced.clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n  \n  debounced.flush = function() {\n    if (timeout) {\n      result = func.apply(context, args);\n      context = args = null;\n      \n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n\n  return debounced;\n};\n","import throttle from 'throttleit';\nimport debounce from 'debounce';\n\nlet count = 0;\nfunction uniqueId() {\n  count += 1;\n  return `OdoWindowEvents${count}`;\n}\n\nfunction callEachWithArg(object, args) {\n  Object.keys(object).forEach((i) => {\n    object[i].call(null, args[0], args[1]);\n  });\n}\n\n/**\n * Retrieves the scroll offsets. This only works for the page scroll. For\n * scroll positions of an element, the `scrollTop` and `scrollLeft` properties\n * need to be used.\n * @return {{top: number, left: number}}\n */\nfunction getScrollPosition() {\n  return {\n    top: window.pageYOffset,\n    left: window.pageXOffset,\n  };\n}\n\n/**\n * Retrieve the dimensions of the viewable screen.\n * @return {{width: number, height: number}}\n */\nfunction getViewportSize() {\n  return {\n    width: window.innerWidth,\n    height: window.innerHeight,\n  };\n}\n\nfunction addCallback(object, fn) {\n  const id = uniqueId();\n  object[id] = fn;\n  return id;\n}\n\nconst WindowEvents = {\n\n  _scrollCallbacks: {},\n  _fastScrollCallbacks: {},\n  _resizeCallbacks: {},\n  _leadingResizeCallbacks: {},\n\n  _callbacks: {\n    resize() {\n      const viewport = getViewportSize();\n      callEachWithArg(WindowEvents._resizeCallbacks, [viewport.width, viewport.height]);\n    },\n\n    leadingResize() {\n      const viewport = getViewportSize();\n      callEachWithArg(WindowEvents._leadingResizeCallbacks, [viewport.width, viewport.height]);\n    },\n\n    scroll() {\n      const scroll = getScrollPosition();\n      callEachWithArg(WindowEvents._scrollCallbacks, [scroll.top, scroll.left]);\n    },\n\n    fastScroll() {\n      const scroll = getScrollPosition();\n      callEachWithArg(WindowEvents._fastScrollCallbacks, [scroll.top, scroll.left]);\n    },\n  },\n\n  Timing: {\n    DEBOUNCE_TIME: 500,\n    THROTTLE_TIME_DEFAULT: 500,\n    THROTTLE_TIME_FAST: 150,\n  },\n\n  /**\n   * Bind a callback to window scroll.\n   * @param {function(number, number):void} fn Callback to execute on scroll.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onScroll(fn) {\n    return addCallback(WindowEvents._scrollCallbacks, fn);\n  },\n\n  /**\n   * Bind a callback to window scroll which executes quicker.\n   * @param {function(number, number):void} fn Callback to execute on scroll.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onFastScroll(fn) {\n    return addCallback(WindowEvents._fastScrollCallbacks, fn);\n  },\n\n  /**\n   * Bind a callback to window resize.\n   * @param {function(number, number):void} fn Callback to execute on resize.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onResize(fn) {\n    return addCallback(WindowEvents._resizeCallbacks, fn);\n  },\n\n  /**\n   * Bind a callback to window resize.\n   * @param {function(number, number):void} fn Callback to execute on resize.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onLeadingResize(fn) {\n    return addCallback(WindowEvents._leadingResizeCallbacks, fn);\n  },\n\n  /**\n   * Remove callback with a given id.\n   * @param {string} id Callback ID to remove.\n   */\n  remove(id) {\n    delete WindowEvents._scrollCallbacks[id];\n    delete WindowEvents._fastScrollCallbacks[id];\n    delete WindowEvents._resizeCallbacks[id];\n    delete WindowEvents._leadingResizeCallbacks[id];\n  },\n};\n\nconst resize = debounce(\n  WindowEvents._callbacks.resize,\n  WindowEvents.Timing.DEBOUNCE_TIME,\n);\nconst leadingResize = debounce(\n  WindowEvents._callbacks.leadingResize,\n  WindowEvents.Timing.DEBOUNCE_TIME, true,\n);\nconst scrolled = throttle(\n  WindowEvents._callbacks.scroll,\n  WindowEvents.Timing.THROTTLE_TIME_DEFAULT,\n);\nconst fastScroll = throttle(\n  WindowEvents._callbacks.fastScroll,\n  WindowEvents.Timing.THROTTLE_TIME_FAST,\n);\n\nWindowEvents._resizeCallback = () => {\n  leadingResize();\n  resize();\n};\n\nWindowEvents._scrollCallback = () => {\n  scrolled();\n  fastScroll();\n};\n\nwindow.addEventListener('resize', WindowEvents._resizeCallback);\nwindow.addEventListener('scroll', WindowEvents._scrollCallback);\n\nexport default WindowEvents;\n"],"names":["throttle","func","wait","ctx","args","rtn","timeoutID","last","throttled","arguments","delta","Date","call","setTimeout","apply","debounce","immediate","timeout","context","timestamp","result","later","now","debounced","callNow","clear","flush","count","uniqueId","callEachWithArg","object","keys","forEach","i","getScrollPosition","window","pageYOffset","pageXOffset","getViewportSize","innerWidth","innerHeight","addCallback","fn","id","WindowEvents","viewport","_resizeCallbacks","width","height","_leadingResizeCallbacks","scroll","_scrollCallbacks","top","left","_fastScrollCallbacks","resize","_callbacks","Timing","DEBOUNCE_TIME","leadingResize","scrolled","THROTTLE_TIME_DEFAULT","fastScroll","THROTTLE_TIME_FAST","_resizeCallback","_scrollCallback","addEventListener"],"mappings":"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"}