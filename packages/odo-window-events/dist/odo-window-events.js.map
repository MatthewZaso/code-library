{"version":3,"file":"odo-window-events.js","sources":["../node_modules/throttleit/index.js","../node_modules/debounce/index.js","../src/window-events.js"],"sourcesContent":["module.exports = throttle;\n\n/**\n * Returns a new function that, when invoked, invokes `func` at most once per `wait` milliseconds.\n *\n * @param {Function} func Function to wrap.\n * @param {Number} wait Number of milliseconds that must elapse between `func` invocations.\n * @return {Function} A new function that wraps the `func` function passed in.\n */\n\nfunction throttle (func, wait) {\n  var ctx, args, rtn, timeoutID; // caching\n  var last = 0;\n\n  return function throttled () {\n    ctx = this;\n    args = arguments;\n    var delta = new Date() - last;\n    if (!timeoutID)\n      if (delta >= wait) call();\n      else timeoutID = setTimeout(call, wait - delta);\n    return rtn;\n  };\n\n  function call () {\n    timeoutID = 0;\n    last = +new Date();\n    rtn = func.apply(ctx, args);\n    ctx = null;\n    args = null;\n  }\n}\n","/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear' \n * that is a function which will clear the timer to prevent previously scheduled executions. \n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\n\nmodule.exports = function debounce(func, wait, immediate){\n  var timeout, args, context, timestamp, result;\n  if (null == wait) wait = 100;\n\n  function later() {\n    var last = Date.now() - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    }\n  };\n\n  var debounced = function(){\n    context = this;\n    args = arguments;\n    timestamp = Date.now();\n    var callNow = immediate && !timeout;\n    if (!timeout) timeout = setTimeout(later, wait);\n    if (callNow) {\n      result = func.apply(context, args);\n      context = args = null;\n    }\n\n    return result;\n  };\n\n  debounced.clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n  \n  debounced.flush = function() {\n    if (timeout) {\n      result = func.apply(context, args);\n      context = args = null;\n      \n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n\n  return debounced;\n};\n","import throttle from 'throttleit';\nimport debounce from 'debounce';\n\nlet count = 0;\nfunction uniqueId() {\n  count += 1;\n  return `OdoWindowEvents${count}`;\n}\n\nfunction callEachWithArg(object, args) {\n  Object.keys(object).forEach((i) => {\n    object[i].call(null, args[0], args[1]);\n  });\n}\n\n/**\n * Retrieves the scroll offsets. This only works for the page scroll. For\n * scroll positions of an element, the `scrollTop` and `scrollLeft` properties\n * need to be used.\n * @return {{top: number, left: number}}\n */\nfunction getScrollPosition() {\n  return {\n    top: window.pageYOffset,\n    left: window.pageXOffset,\n  };\n}\n\n/**\n * Retrieve the dimensions of the viewable screen.\n * @return {{width: number, height: number}}\n */\nfunction getViewportSize() {\n  return {\n    width: window.innerWidth,\n    height: window.innerHeight,\n  };\n}\n\nfunction addCallback(object, fn) {\n  const id = uniqueId();\n  object[id] = fn;\n  return id;\n}\n\nconst WindowEvents = {\n\n  _scrollCallbacks: {},\n  _fastScrollCallbacks: {},\n  _resizeCallbacks: {},\n  _leadingResizeCallbacks: {},\n\n  _callbacks: {\n    resize() {\n      const viewport = getViewportSize();\n      callEachWithArg(WindowEvents._resizeCallbacks, [viewport.width, viewport.height]);\n    },\n\n    leadingResize() {\n      const viewport = getViewportSize();\n      callEachWithArg(WindowEvents._leadingResizeCallbacks, [viewport.width, viewport.height]);\n    },\n\n    scroll() {\n      const scroll = getScrollPosition();\n      callEachWithArg(WindowEvents._scrollCallbacks, [scroll.top, scroll.left]);\n    },\n\n    fastScroll() {\n      const scroll = getScrollPosition();\n      callEachWithArg(WindowEvents._fastScrollCallbacks, [scroll.top, scroll.left]);\n    },\n  },\n\n  Timing: {\n    DEBOUNCE_TIME: 500,\n    THROTTLE_TIME_DEFAULT: 500,\n    THROTTLE_TIME_FAST: 150,\n  },\n\n  /**\n   * Bind a callback to window scroll.\n   * @param {function(number, number):void} fn Callback to execute on scroll.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onScroll(fn) {\n    return addCallback(WindowEvents._scrollCallbacks, fn);\n  },\n\n  /**\n   * Bind a callback to window scroll which executes quicker.\n   * @param {function(number, number):void} fn Callback to execute on scroll.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onFastScroll(fn) {\n    return addCallback(WindowEvents._fastScrollCallbacks, fn);\n  },\n\n  /**\n   * Bind a callback to window resize.\n   * @param {function(number, number):void} fn Callback to execute on resize.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onResize(fn) {\n    return addCallback(WindowEvents._resizeCallbacks, fn);\n  },\n\n  /**\n   * Bind a callback to window resize.\n   * @param {function(number, number):void} fn Callback to execute on resize.\n   * @return {string} id of event, to be used with service's remove method.\n   */\n  onLeadingResize(fn) {\n    return addCallback(WindowEvents._leadingResizeCallbacks, fn);\n  },\n\n  /**\n   * Remove callback with a given id.\n   * @param {string} id Callback ID to remove.\n   */\n  remove(id) {\n    delete WindowEvents._scrollCallbacks[id];\n    delete WindowEvents._fastScrollCallbacks[id];\n    delete WindowEvents._resizeCallbacks[id];\n    delete WindowEvents._leadingResizeCallbacks[id];\n  },\n};\n\nconst resize = debounce(\n  WindowEvents._callbacks.resize,\n  WindowEvents.Timing.DEBOUNCE_TIME,\n);\nconst leadingResize = debounce(\n  WindowEvents._callbacks.leadingResize,\n  WindowEvents.Timing.DEBOUNCE_TIME, true,\n);\nconst scrolled = throttle(\n  WindowEvents._callbacks.scroll,\n  WindowEvents.Timing.THROTTLE_TIME_DEFAULT,\n);\nconst fastScroll = throttle(\n  WindowEvents._callbacks.fastScroll,\n  WindowEvents.Timing.THROTTLE_TIME_FAST,\n);\n\nWindowEvents._resizeCallback = () => {\n  leadingResize();\n  resize();\n};\n\nWindowEvents._scrollCallback = () => {\n  scrolled();\n  fastScroll();\n};\n\nwindow.addEventListener('resize', WindowEvents._resizeCallback);\nwindow.addEventListener('scroll', WindowEvents._scrollCallback);\n\nexport default WindowEvents;\n"],"names":["throttle","func","wait","ctx","args","rtn","timeoutID","last","throttled","arguments","delta","Date","call","setTimeout","apply","debounce","immediate","timeout","context","timestamp","result","later","now","debounced","callNow","clear","clearTimeout","flush","count","uniqueId","callEachWithArg","object","Object","keys","forEach","i","getScrollPosition","top","window","pageYOffset","left","pageXOffset","getViewportSize","width","innerWidth","height","innerHeight","addCallback","fn","id","WindowEvents","_scrollCallbacks","_fastScrollCallbacks","_resizeCallbacks","_leadingResizeCallbacks","_callbacks","resize","viewport","leadingResize","scroll","fastScroll","Timing","DEBOUNCE_TIME","THROTTLE_TIME_DEFAULT","THROTTLE_TIME_FAST","onScroll","onFastScroll","onResize","onLeadingResize","remove","scrolled","_resizeCallback","_scrollCallback","addEventListener"],"mappings":"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"}