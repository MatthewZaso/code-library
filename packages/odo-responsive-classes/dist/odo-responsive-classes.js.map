{"version":3,"file":"odo-responsive-classes.js","sources":["../src/responsive-classes-element.js","../src/responsive-classes.js"],"sourcesContent":["import OdoResponsiveAttributes from '@odopod/odo-responsive-attributes';\n\nclass ResponsiveClassesElement {\n  constructor(element) {\n    /**\n     * Main element.\n     * @type {Element}\n     */\n    this.element = element;\n\n    /**\n     * Read responsive attributes on the main element.\n     * e.g. `data-class.md=\"foo\"`.\n     * @type {OdoResponsiveAttributes}\n     * @private\n     */\n    this._attributes = new OdoResponsiveAttributes(element, 'class');\n  }\n\n  /**\n   * Add multiple classes to the main element.\n   * @param {string[]} classesToAdd Classes to add.\n   */\n  _addAllClasses(classesToAdd) {\n    this.element.classList.add(...classesToAdd);\n  }\n\n  /**\n  * Remove multiple classes to the main element.\n  * @param {string[]} classesToRemove Classes to add.\n  */\n  _removeAllClasses(classesToRemove) {\n    Object.keys(classesToRemove).forEach((breakpoint) => {\n      if (classesToRemove[breakpoint]) {\n        this.element.classList.remove(...classesToRemove[breakpoint].split(' '));\n      }\n    });\n  }\n\n  /**\n   * Split read and writing to and from the DOM into separate methods so that\n   * reads can be batched together and writes can be batched together. This\n   * avoids layout thrashing.\n   */\n  read() {\n    this._attributes.update();\n  }\n\n  /**\n   * Update current classes on the element.\n   */\n  write() {\n    this._removeAllClasses(this._attributes.values);\n    this._addAllClasses(this._attributes.currentValue === null ?\n      [] :\n      this._attributes.currentValue.split(' '));\n  }\n\n  /**\n   * Cleanup.\n   */\n  dispose() {\n    this._attributes.dispose();\n    this.element = null;\n  }\n}\n\nexport default ResponsiveClassesElement;\n","import OdoBaseComponent from '@odopod/odo-base-component';\nimport ResponsiveClassesElement from './responsive-classes-element';\n\nclass ResponsiveClasses extends OdoBaseComponent {\n  constructor() {\n    super(document.body, true);\n    this.items = [];\n    this.initializeAll();\n  }\n\n  /**\n   * When the browser matches a new media query, update.\n   * @override\n   */\n  onMediaQueryChange() {\n    this.process();\n  }\n\n  /**\n   * Dispose of class name switchers.\n   * @param {ArrayLike.<Element>} elements Array of class name switcher elements.\n   */\n  removeAll(elements) {\n    const els = Array.from(elements);\n    const items = this.items.filter(item => els.indexOf(item.element) > -1);\n\n    items.forEach((item) => {\n      this.items.splice(this.items.indexOf(item), 1);\n      item.dispose();\n    });\n  }\n\n  /**\n  * Create instances to track.\n  * @param {ArrayLike.<Element>} elements\n  */\n  addAll(elements) {\n    const newItems = [];\n\n    for (let i = 0, len = elements.length; i < len; i++) {\n      newItems.push(new ResponsiveClassesElement(elements[i]));\n    }\n\n    // Merge new items into current items.\n    this.items = this.items.concat(newItems);\n\n    this.process();\n  }\n\n  /**\n   * Initializes all ResponsiveClasses instances on the page or within the given\n   * context.\n   *\n   * @param {Element} [context] Optionally provide the context (scope)\n   *     for the query. Default is the body.\n   */\n  initializeAll(context = document.body) {\n    this.addAll(context.querySelectorAll('.odo-responsive-classes'));\n  }\n\n  /**\n   * Dispose of all ResponsiveClassesElement instances from within a context.\n   * @param {Element} context Scope for the query.\n   */\n  disposeAll(context) {\n    this.removeAll(context.querySelectorAll('.odo-responsive-classes'));\n  }\n\n  /**\n   * By reading values from the DOM all at once, then writing to the DOM all at\n   * once, layout thrashing is avoided, optimizing this code path.\n   */\n  process() {\n    this.items.forEach((item) => {\n      item.read();\n    });\n\n    this.items.forEach((item) => {\n      item.write();\n    });\n  }\n}\n\nexport default new ResponsiveClasses();\n"],"names":["ResponsiveClassesElement","element","_attributes","OdoResponsiveAttributes","_addAllClasses","classesToAdd","classList","add","_removeAllClasses","classesToRemove","Object","keys","forEach","breakpoint","remove","split","read","update","write","values","currentValue","dispose","ResponsiveClasses","document","body","items","initializeAll","onMediaQueryChange","process","removeAll","elements","els","Array","from","filter","indexOf","item","splice","addAll","newItems","i","len","length","push","concat","context","querySelectorAll","disposeAll","OdoBaseComponent"],"mappings":"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"}