!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@odopod/odo-helpers"),require("@odopod/odo-window-events")):"function"==typeof define&&define.amd?define(["exports","@odopod/odo-helpers","@odopod/odo-window-events"],e):e(t.OdoExpandable={},t.OdoHelpers,t.OdoWindowEvents)}(this,function(t,e,i){"use strict";i=i&&i.hasOwnProperty("default")?i.default:i;var r={ClassName:{TRIGGER_OPEN:"odo-expandable__trigger--open",TARGET_OPEN:"odo-expandable__target--open"},Attribute:{TRIGGER:"data-expandable-trigger",GROUP:"data-expandable-group",ANIMATED:"data-expandable-animated"},Defaults:{groupedItem:!1}},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},s=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),this.id=e,this.options=Object.assign({},r.Defaults,i),this.trigger=document.body.querySelector("["+r.Attribute.TRIGGER+'="'+e+'"]'),this.target=document.getElementById(e),this.isOpen=this.target.classList.contains(r.ClassName.TARGET_OPEN),this.trigger.id||(this.trigger.id="odo-expandable-trigger--"+this.id),this._setA11yAttributes(),this.isOpen&&this.open(),this.options.groupedItem||(this._onTriggerClick=this._triggerClickHandler.bind(this),document.body.addEventListener("click",this._onTriggerClick))}return t.prototype._triggerClickHandler=function(t){t.target.closest("["+r.Attribute.TRIGGER+"]")===this.trigger&&(t.preventDefault(),this.toggle())},t.prototype._setA11yAttributes=function(){this.trigger.setAttribute("aria-expanded",this.isOpen.toString()),this.trigger.setAttribute("aria-controls",this.id),this.target.setAttribute("aria-labelledby",this.trigger.id),this.target.setAttribute("aria-hidden",(!this.isOpen).toString())},t.prototype._removeA11yAttributes=function(){this.trigger.removeAttribute("aria-expanded"),this.trigger.removeAttribute("aria-controls"),this.target.removeAttribute("aria-labelledby"),this.target.removeAttribute("aria-hidden")},t.prototype.toggle=function(){this.isOpen?this.close():this.open()},t.prototype.open=function(){this.target.classList.add(r.ClassName.TARGET_OPEN),this.trigger.classList.add(r.ClassName.TRIGGER_OPEN),this.trigger.setAttribute("aria-expanded","true"),this.target.setAttribute("aria-hidden","false"),this.isOpen=!0},t.prototype.close=function(){this.target.classList.remove(r.ClassName.TARGET_OPEN),this.trigger.classList.remove(r.ClassName.TRIGGER_OPEN),this.trigger.setAttribute("aria-expanded","false"),this.target.setAttribute("aria-hidden","true"),this.isOpen=!1},t.prototype.dispose=function(){this.options.groupedItem||document.body.removeEventListener("click",this._onTriggerClick),this._removeA11yAttributes()},t}();Object.assign(s,r);var a=function(){function t(e){o(this,t),this._elements=e,this.expandables=e.map(function(t){return new s(t.getAttribute(r.Attribute.TRIGGER),{groupedItem:!0})}),this._onClick=this._onClickHandler.bind(this),document.body.addEventListener("click",this._onClick)}return t.prototype._onClickHandler=function(t){var e=t.target.closest("["+r.Attribute.TRIGGER+"]");this._elements.includes(e)&&(t.preventDefault(),this.toggleVisibility(e.getAttribute(r.Attribute.TRIGGER)))},t.prototype.toggleVisibility=function(t){this.expandables.forEach(function(e){e.id===t?e.toggle():e.close()})},t.prototype.dispose=function(){document.body.removeEventListener("click",this._onClick),this.expandables.forEach(function(t){return t.dispose()})},t}();Object.assign(a,r);var d=function(t){function r(e){o(this,r);var s=n(this,t.call(this,e));return s._expandableOffsets=[],s.update(),s._resizeId=i.onResize(s.update.bind(s)),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,t),r.prototype.update=function(){var t=this,e=this.expandables.map(function(t){return t.isOpen});this.expandables.forEach(function(e){e.target.style.transitionDuration="0s",e.close(),t._setHeight(e,!1)}),this._expandableOffsets=this._getOffsets(),this.expandables.forEach(function(i,r){t._setHeight(i,e[r])}),this.expandables[0].trigger.offsetWidth,this.expandables.forEach(function(t,i){t.target.style.transitionDuration="",e[i]&&t.open()})},r.prototype.toggleVisibility=function(e){var i=this;this.expandables.forEach(function(t){i._animateHeight(t,t.id===e)}),t.prototype.toggleVisibility.call(this,e),this._scrollToSelected(e)},r.prototype._getOffsets=function(){var t=window.pageYOffset;return this.expandables.map(function(e){return{id:e.id,offset:t+e.trigger.getBoundingClientRect().top}})},r.prototype._scrollToSelected=function(t){var i=this._expandableOffsets.find(function(e){return e.id===t});i.offset<window.pageYOffset&&e.scrollTo(i.offset,300)},r.prototype._setHeight=function(t,e){var i=e?t.target.firstElementChild.offsetHeight:0;t.target.style.height=i+"px"},r.prototype._animateHeight=function(t,e){(e||t.isOpen)&&this._setHeight(t,!t.isOpen)},r.prototype.dispose=function(){t.prototype.dispose.call(this),i.remove(this._resizeId)},r}(a);t.initializeAll=function(){var t=Array.from(document.querySelectorAll("["+r.Attribute.TRIGGER+"]")),e=[],i=[],o=[];return t.forEach(function(n){var u=n.getAttribute(r.Attribute.GROUP);if(u){if(!o.includes(u)){var p=t.filter(function(t){return t.getAttribute(r.Attribute.GROUP)===u}),l=p.some(function(t){return t.hasAttribute(r.Attribute.ANIMATED)});i.push(l?new d(p):new a(p)),o.push(u)}}else e.push(new s(n.getAttribute(r.Attribute.TRIGGER)))}),e.concat(i)},t.Settings=r,t.ExpandableItem=s,t.ExpandableGroup=a,t.ExpandableAccordion=d,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=odo-expandable.min.js.map
