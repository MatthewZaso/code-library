!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("tiny-emitter"),require("@odopod/odo-helpers"),require("@odopod/odo-window-events")):"function"==typeof define&&define.amd?define(["tiny-emitter","@odopod/odo-helpers","@odopod/odo-window-events"],t):e.OdoTabs=t(e.TinyEmitter,e.OdoHelpers,e.OdoWindowEvents)}(this,function(e,t,s){"use strict";function n(){return"odo-tabs"+(h+=1)}e=e&&e.hasOwnProperty("default")?e.default:e,s=s&&s.hasOwnProperty("default")?s.default:s;var i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},r=function(){function e(t,s){i(this,e),this.type=t,this.index=s,this.defaultPrevented=!1}return e.prototype.preventDefault=function(){this.defaultPrevented=!0},e}(),h=0,d=function(e){function h(t){i(this,h);var s=o(this,e.call(this));return s.element=t,s._selectedIndex=-1,s.tabs=Array.from(s.element.children),s.anchors=s.tabs.map(function(e){return e.querySelector("a")}),s.panes=s.anchors.map(function(e){return document.getElementById(e.getAttribute("href").substring(1))}),s.panesContainer=s.panes[0].parentNode,s.hashes=s.anchors.map(function(e){return e.getAttribute("data-hash")}),s.init(),s}return a(h,e),h.prototype.init=function(){var e=this.getStartingIndex();this._setupHandlers(),this._processTabs(),this.setSelectedIndex(e,!0)},h.prototype.getStartingIndex=function(){var e=this._getWindowHashIndex();if(e>-1)return e;var t=this.panes.findIndex(function(e){return e.matches("."+h.ClassName.IS_SELECTED)});return t>-1?t:0},h.prototype._processTabs=function(){var e=this;this.element.classList.add(h.ClassName.TABS),this.element.setAttribute("role","tablist"),this.tabs.forEach(function(e){e.setAttribute("role","presentation")}),this.anchors.forEach(function(s,i){s.setAttribute("role","tab"),s.setAttribute("tabIndex",-1),s.setAttribute("aria-selected",!1),t.dom.giveId(s,n);var a=e.panes[i];s.setAttribute("aria-controls",a.id),a.setAttribute("aria-labelledby",s.id)}),this.panes.forEach(function(e){e.setAttribute("role","tabpanel"),e.setAttribute("aria-hidden",!0)})},h.prototype._setupHandlers=function(){this._onClick=this._handleClick.bind(this),this._onKeydown=this._handleKeydown.bind(this),this._onHashChange=this._handleHashChange.bind(this),this.element.addEventListener("click",this._onClick),this.element.addEventListener("keydown",this._onKeydown),window.addEventListener("hashchange",this._onHashChange),this._resizeId=s.onResize(this.update.bind(this))},h.prototype._handleClick=function(e){e.preventDefault();var t=e.target.closest("."+h.ClassName.TAB);t&&this.setSelectedIndex(this.tabs.indexOf(t))},h.prototype._handleKeydown=function(e){var s=this._getFocusedTabIndex();switch(e.which){case 39:case 40:s+=1;break;case 37:case 38:s-=1;break;case 32:case 13:return e.preventDefault(),void this.setSelectedIndex(s);default:return}e.preventDefault(),this._focusTab(t.math.clamp(s,0,this.tabs.length-1))},h.prototype._handleHashChange=function(){var e=this._getWindowHashIndex();e>-1&&this.setSelectedIndex(e)},h.prototype.update=function(){var e=this.panes[this.getSelectedIndex()].offsetHeight;this.panesContainer.style.height=e+"px"},h.prototype._getWindowHashIndex=function(){return this.hashes.indexOf(window.location.hash.substring(1))},h.prototype._getFocusedTabIndex=function(){var e=document.activeElement.closest("."+h.ClassName.TAB);return this.tabs.indexOf(e)},h.prototype._focusTab=function(e){this.anchors[e].focus()},h.prototype.getSelectedIndex=function(){return this._selectedIndex},h.prototype.setSelectedIndex=function(e,s){if(!(e===this._selectedIndex||e<0||e>=this.tabs.length)){var n=new r(h.EventType.WILL_SHOW,e);if(this.emit(n.type,n),!n.defaultPrevented){this._selectTab(e),this._selectPane(e),this._selectedIndex=e,!s&&this.hashes[e]&&t.browser.setHash(this.hashes[e]);var i=new r(h.EventType.DID_SHOW,e);this.emit(i.type,i)}}},h.prototype._selectTab=function(e){var t=this.tabs[e],s=this.tabs[this.getSelectedIndex()],n=this.anchors[e],i=this.anchors[this.getSelectedIndex()];s&&(s.classList.remove(h.ClassName.IS_SELECTED),i.classList.remove(h.ClassName.IS_SELECTED),i.setAttribute("tabIndex",-1),i.setAttribute("aria-selected",!1)),t.classList.add(h.ClassName.IS_SELECTED),n.classList.add(h.ClassName.IS_SELECTED),n.setAttribute("tabIndex",0),n.setAttribute("aria-selected",!0)},h.prototype._selectPane=function(e){var t=this.panes[e],s=this.panes[this.getSelectedIndex()],n=t.offsetHeight;s&&(s.classList.remove(h.ClassName.IS_SELECTED),s.setAttribute("aria-hidden",!0)),t.classList.add(h.ClassName.IS_SELECTED),t.setAttribute("aria-hidden",!1),this.panesContainer.style.height=n+"px"},h.prototype.dispose=function(){this.element.classList.remove(h.ClassName.TABS),this.element.removeAttribute("role");for(var e=this.tabs.length-1;e>=0;e--){var t=this.tabs[e],n=this.anchors[e],i=this.panes[e];t.classList.remove(h.ClassName.IS_SELECTED),n.classList.remove(h.ClassName.IS_SELECTED),i.classList.remove(h.ClassName.IS_SELECTED),t.removeAttribute("role"),n.removeAttribute("role"),n.removeAttribute("tabIndex"),n.removeAttribute("aria-selected"),n.removeAttribute("aria-controls"),i.removeAttribute("role"),i.removeAttribute("aria-labelledby"),i.removeAttribute("aria-hidden")}this.panesContainer.style.height="",this.element.removeEventListener("click",this._onClick),this.element.removeEventListener("keydown",this._onKeydown),window.removeEventListener("hashchange",this._onHashChange),s.remove(this._resizeId),this.element=null,this.anchors=null,this.panes=null,this.panesContainer=null,this._selectedIndex=-1},h}(e);return d.ClassName={TABS:"odo-tabs",TAB:"odo-tabs__tab",IS_SELECTED:"is-selected"},d.EventType={WILL_SHOW:"odotabs:willshow",DID_SHOW:"odotabs:didshow"},d});
//# sourceMappingURL=odo-tabs.min.js.map
