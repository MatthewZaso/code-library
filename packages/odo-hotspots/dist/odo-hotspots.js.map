{"version":3,"file":"odo-hotspots.js","sources":["../node_modules/debounce/index.js","../src/settings.js","../src/unique-id.js","../src/hotspot.js","../src/hotspots.js"],"sourcesContent":["/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear' \n * that is a function which will clear the timer to prevent previously scheduled executions. \n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\n\nmodule.exports = function debounce(func, wait, immediate){\n  var timeout, args, context, timestamp, result;\n  if (null == wait) wait = 100;\n\n  function later() {\n    var last = Date.now() - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    }\n  };\n\n  var debounced = function(){\n    context = this;\n    args = arguments;\n    timestamp = Date.now();\n    var callNow = immediate && !timeout;\n    if (!timeout) timeout = setTimeout(later, wait);\n    if (callNow) {\n      result = func.apply(context, args);\n      context = args = null;\n    }\n\n    return result;\n  };\n\n  debounced.clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n\n  return debounced;\n};\n","export default {\n  ClassName: {\n    HOTSPOT: 'odo-hotspot',\n    HOTSPOT_LEFT: 'odo-hotspot--left',\n    HOTSPOT_RIGHT: 'odo-hotspot--right',\n    HOTSPOT_TOP: 'odo-hotspot--top',\n    HOTSPOT_BOTTOM: 'odo-hotspot--bottom',\n    BUTTON: 'odo-hotspot__button',\n    CONTENT: 'odo-hotspot__content',\n    LOADED: 'is-loaded',\n    OPEN: 'is-open',\n  },\n\n  EventType: {\n    INITIALIZED: 'odohotspotsinitialized',\n    WILL_OPEN: 'odohotspotswillopen',\n    WILL_CLOSE: 'odohotspotswillclose',\n  },\n};\n","let count = 0;\nexport default function setUniqueId(element) {\n  if (!element.id) {\n    count += 1;\n    element.id = `odo-hotspots${count}`;\n  }\n}\n","import settings from './settings';\nimport setUniqueId from './unique-id';\n\nclass Hotspot {\n  /**\n   * The hotspot class represents a single hotspot.\n   * @param {Element} element Main wrapper element for the hotspot.\n   * @param {Hotspots} parent A reference to the parent class.\n   * @constructor\n   */\n  constructor(element, parent) {\n    this.parent = parent;\n    this.isOpen = false;\n    this.wrapper = element;\n    this.button = element.querySelector('.' + settings.ClassName.BUTTON);\n    this.content = element.querySelector('.' + settings.ClassName.CONTENT);\n    this.percentPosition = this.parseWrapperPosition();\n    this.size = this.getContentSize();\n    this.side = this.getSide();\n    this.anchor = this.getAnchor();\n    this.position = this.getWrapperPosition();\n  }\n\n  /**\n   * Converts the data-position=\"x,y\" attribute to an object with x and y properties.\n   * @return {{x: number, y: number}}\n   */\n  parseWrapperPosition() {\n    const positions = this.wrapper.getAttribute('data-position').split(',');\n    return {\n      x: parseFloat(positions[0]),\n      y: parseFloat(positions[1]),\n    };\n  }\n\n  /**\n   * Returns the width and height of the content element.\n   * @return {{width: number, height: number}}\n   */\n  getContentSize() {\n    return {\n      width: this.content.offsetWidth,\n      height: this.content.offsetHeight,\n    };\n  }\n\n  /**\n   * Returns the class name of the side the hotspot should go to. If it doesn't\n   * have a side, a side will be calculated for it.\n   * @return {?string}\n   */\n  getSide() {\n    if (this.wrapper.classList.contains(settings.ClassName.HOTSPOT_LEFT)) {\n      return settings.ClassName.HOTSPOT_LEFT;\n    } else if (this.wrapper.classList.contains(settings.ClassName.HOTSPOT_RIGHT)) {\n      return settings.ClassName.HOTSPOT_RIGHT;\n    }\n    return null;\n  }\n\n  /**\n   * Returns the class name of the anchor the hotspot should go to. If it doesn't\n   * have a anchor, a anchor will be calculated for it.\n   * @return {?string}\n   */\n  getAnchor() {\n    if (this.wrapper.classList.contains(settings.ClassName.HOTSPOT_TOP)) {\n      return settings.ClassName.HOTSPOT_TOP;\n    } else if (this.wrapper.classList.contains(settings.ClassName.HOTSPOT_BOTTOM)) {\n      return settings.ClassName.HOTSPOT_BOTTOM;\n    }\n    return null;\n  }\n\n  /**\n   * Updates the position and size of the hotspot.\n   */\n  refresh() {\n    // Read\n    this.percentPosition = this.parseWrapperPosition();\n    this.size = this.getContentSize();\n    this.position = this.getWrapperPosition();\n\n    // Write async so that multiple hotspots can be refreshed at a time without\n    // causing layout thrashing.\n    this.refreshId = requestAnimationFrame(() => {\n      this._removeContentPosition();\n      this.setPosition();\n    });\n  }\n\n  /**\n   * Applies the data-position attribute to the wrapper.\n   */\n  _setWrapperPosition() {\n    this.wrapper.style.left = this.percentPosition.x + '%';\n    this.wrapper.style.top = this.percentPosition.y + '%';\n  }\n\n  /**\n   * Returns a rectangle describing the wrapper (not the content).\n   * @return {Object}\n   */\n  getWrapperPosition() {\n    const left = Math.round(this.parent.size.width * this.percentPosition.x / 100);\n    const top = Math.round(this.parent.size.height * this.percentPosition.y / 100);\n    const width = Math.round(this.wrapper.offsetWidth);\n    const height = Math.round(this.wrapper.offsetHeight);\n    return {\n      left,\n      top,\n      right: left + width,\n      bottom: top + height,\n    };\n  }\n\n  /**\n   * Determines the side which the hotspot should go to based on the container's\n   * width and the width of the hotspot content.\n   * @return {string}\n   */\n  _getOptimalSide() {\n    let side = null;\n\n    const fitsRight = this.position.right + this.size.width <= this.parent.size.width;\n    const fitsLeft = this.position.left - this.size.width >= 0;\n\n    // If both or neither fit, choose the side which has more room.\n    if ((fitsLeft && fitsRight) || (!fitsLeft && !fitsRight)) {\n      if (this.percentPosition.x < 50) {\n        side = settings.ClassName.HOTSPOT_RIGHT;\n      } else {\n        side = settings.ClassName.HOTSPOT_LEFT;\n      }\n\n    // If only on side fits, then it has to be chosen.\n    } else if (fitsRight) {\n      side = settings.ClassName.HOTSPOT_RIGHT;\n    } else /* fitsLeft */ {\n      side = settings.ClassName.HOTSPOT_LEFT;\n    }\n\n    return side;\n  }\n\n  /**\n   * Determines the anchor which the hotspot should go to based on the container's\n   * height and the height of the hotspot content.\n   * @return {string}\n   */\n  _getOptimalAnchor() {\n    let anchor = null;\n\n    const fitsTop = this.position.bottom - this.size.height >= 0;\n    const fitsBottom = this.position.top + this.size.height <= this.parent.size.height;\n\n    // If both or neither fit, choose the anchor which has more room.\n    if ((fitsBottom && fitsTop) || (!fitsBottom && !fitsTop)) {\n      if (this.percentPosition.y > 50) {\n        anchor = settings.ClassName.HOTSPOT_TOP;\n      } else {\n        anchor = settings.ClassName.HOTSPOT_BOTTOM;\n      }\n\n    // If only on anchor fits, then it has to be chosen.\n    } else if (fitsTop) {\n      anchor = settings.ClassName.HOTSPOT_TOP;\n    } else /* fitsBottom */ {\n      anchor = settings.ClassName.HOTSPOT_BOTTOM;\n    }\n\n    return anchor;\n  }\n\n  /**\n   * If the hotspot does not have a side or anchor, they will be set for it.\n   */\n  _setContentPosition() {\n    if (this.side === null) {\n      this.wrapper.classList.add(this._getOptimalSide());\n    }\n\n    if (this.anchor === null) {\n      this.wrapper.classList.add(this._getOptimalAnchor());\n    }\n  }\n\n  /**\n   * If the hotspot did not have a side or anchor originally, they will be removed.\n   */\n  _removeContentPosition() {\n    if (this.side === null) {\n      this.wrapper.classList.remove(\n        settings.ClassName.HOTSPOT_LEFT,\n        settings.ClassName.HOTSPOT_RIGHT,\n      );\n    }\n\n    if (this.anchor === null) {\n      this.wrapper.classList.remove(\n        settings.ClassName.HOTSPOT_TOP,\n        settings.ClassName.HOTSPOT_BOTTOM,\n      );\n    }\n  }\n\n  /**\n   * Positions the wrapper and the content.\n   */\n  setPosition() {\n    this._setWrapperPosition();\n    this._setContentPosition();\n  }\n\n  /**\n   * Show the hotspot.\n   */\n  show() {\n    this.wrapper.classList.add(settings.ClassName.OPEN);\n    this.content.setAttribute('aria-hidden', false);\n    this.button.setAttribute('aria-describedby', this.content.id);\n    this.isOpen = true;\n  }\n\n  /**\n   * Hide the hotspot.\n   */\n  hide() {\n    this.wrapper.classList.remove(settings.ClassName.OPEN);\n    this.content.setAttribute('aria-hidden', true);\n    this.button.removeAttribute('aria-describedby');\n    this.isOpen = false;\n  }\n\n  /**\n   * Set accessibility attributes so that the implementor doesn't have to worry\n   * about it.\n   */\n  setA11yAttributes() {\n    setUniqueId(this.content);\n    this.content.setAttribute('aria-hidden', true);\n    this.content.setAttribute('role', 'tooltip');\n  }\n\n  _removeA11yAttributes() {\n    this.button.removeAttribute('aria-hidden');\n    this.content.removeAttribute('role');\n  }\n\n  /**\n   * Destroys the hotspot instance. It removes DOM references, classes, and styles\n   * set by this class.\n   */\n  dispose() {\n    cancelAnimationFrame(this.refreshId);\n    this._removeContentPosition();\n    this._removeA11yAttributes();\n    this.wrapper.style.left = '';\n    this.wrapper.style.top = '';\n    this.wrapper = null;\n    this.button = null;\n    this.content = null;\n    this.parent = null;\n  }\n}\n\nexport default Hotspot;\n","import TinyEmitter from 'tiny-emitter';\nimport debounce from 'debounce';\nimport Hotspot from './hotspot';\nimport settings from './settings';\n\nclass Hotspots extends TinyEmitter {\n  /**\n   * Component which has a draggable element in the middle which reveals one or\n   * the other sides as the user drags.\n   *\n   * @constructor\n   */\n  constructor(el) {\n    super();\n    this.element = el;\n\n    this.size = this._getContainerSize();\n    this.hotspots = this._getHotspots();\n    this._noopElement = this._getFirstBodyDescendant();\n    this._noop = () => {};\n\n    this._activeHotspot = null;\n\n    this._bindEvents();\n\n    this.hotspots.forEach((hotspot) => {\n      hotspot.setA11yAttributes();\n      hotspot.setPosition();\n    });\n\n    this.element.classList.add(Hotspots.ClassName.LOADED);\n    this.dispatchEvent(Hotspots.EventType.INITIALIZED);\n  }\n\n  /**\n   * Scope the query to the main element.\n   * @param {string} className Class name of the desired elements.\n   * @return {Array.<Element>} An array of elements.\n   */\n  getElementsByClass(className) {\n    return Array.from(this.element.querySelectorAll('.' + className));\n  }\n\n  /**\n   * In iOS, event delegation does not work for click events.\n   * http://www.quirksmode.org/blog/archives/2010/09/click_event_del.html\n   * @return {?Element} The first child of the body which is a parent of the\n   *     main element in this class.\n   */\n  _getFirstBodyDescendant() {\n    let { element } = this;\n    while (element) {\n      const parent = element.parentElement;\n      if (parent === document.body) {\n        return element;\n      }\n\n      element = parent;\n    }\n\n    return null;\n  }\n\n  /**\n   * Creates the hotspot instances.\n   * @return {Array.<Hotspot>}\n   */\n  _getHotspots() {\n    return this.getElementsByClass(Hotspots.ClassName.HOTSPOT)\n      .map(element => new Hotspot(element, this));\n  }\n\n  /**\n   * Finds the hotspot instance which uses the given wrapper element.\n   * @param {Element} wrapper Element.\n   * @return {?Hotspot}\n   */\n  _getHotspotByWrapper(wrapper) {\n    for (let i = 0, len = this.hotspots.length; i < len; i++) {\n      if (this.hotspots[i].wrapper === wrapper) {\n        return this.hotspots[i];\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Retrieves the dimensions of the main element.\n   * @return {{width: number, height: number}}\n   */\n  _getContainerSize() {\n    return {\n      width: this.element.offsetWidth,\n      height: this.element.offsetHeight,\n    };\n  }\n\n  /**\n   * Triggers a custom event on the main element.\n   * @param {string} eventName Name of event.\n   * @param {Hotspot} [hotspot] Optional hotspot object.\n   * @return {boolean} Whether preventDefault was called on the event.\n   */\n  dispatchEvent(eventName, hotspot) {\n    const event = {\n      defaultPrevented: false,\n      preventDefault() {\n        this.defaultPrevented = true;\n      },\n    };\n\n    if (hotspot) {\n      event.hotspot = hotspot;\n    }\n\n    this.emit(eventName, event);\n    return event.defaultPrevented;\n  }\n\n  /**\n   * Add event listeners.\n   */\n  _bindEvents() {\n    this._clickHandler = this._handleHotspotClick.bind(this);\n    this._resizeHandler = debounce(this._handleResize.bind(this), 200);\n    this._loadHandler = this._handleLoad.bind(this);\n    this._outerClickHandler = this._handleOuterClick.bind(this);\n\n    window.addEventListener('resize', this._resizeHandler, false);\n    window.addEventListener('load', this._loadHandler, false);\n\n    this.hotspots.forEach((hotspot) => {\n      hotspot.button.addEventListener('click', this._clickHandler, false);\n    });\n  }\n\n  /**\n   * Closes all open hotspots so that only one can be open at a time.\n   */\n  closeAllHotspots() {\n    this.hotspots.forEach((hotspot) => {\n      this.closeHotspot(hotspot);\n    });\n  }\n\n  /**\n   * Toggles the display of a hotspot.\n   * @param {Hotspot} hotspot Hotspot to toggle.\n   */\n  toggleHotspot(hotspot) {\n    if (hotspot.isOpen) {\n      this.closeHotspot(hotspot);\n    } else {\n      this.openHotspot(hotspot);\n    }\n  }\n\n  /**\n   * Attempts to show the hotspot. It will emit an event which, if preventDefault\n   * is called on, can be canceled.\n   * @param {Hotspot} hotspot Hotspot to open.\n   */\n  openHotspot(hotspot) {\n    // If preventDefault is called on this event, do not open the hotspot.\n    if (hotspot.isOpen || this.dispatchEvent(Hotspots.EventType.WILL_OPEN, hotspot)) {\n      return;\n    }\n\n    this.closeAllHotspots();\n    hotspot.show();\n    this.setActiveHotspot(hotspot);\n\n    // Listen for clicks outside the hotspot which will close it.\n    // In a timeout so that a click on the hotspot button doesn't bubble\n    // up to the body and register as a click outside the hotspot.\n    setTimeout(() => {\n      this._listenForOuterClicks();\n    }, 0);\n  }\n\n  /**\n   * Attempts to hide the hotspot. It will emit an event which, if preventDefault\n   * is called on, can be canceled.\n   * @param {Hotspot} hotspot Hotspot to close.\n   */\n  closeHotspot(hotspot) {\n    // If preventDefault is called on this event, do not close the hotspot.\n    if (!hotspot.isOpen || this.dispatchEvent(Hotspots.EventType.WILL_CLOSE, hotspot)) {\n      return;\n    }\n\n    hotspot.hide();\n    this.setActiveHotspot(null);\n    this._removeOuterClick();\n  }\n\n  /**\n   * Bind a click listener to the body which closes any active hotspots if the\n   * user clicked outside of the current hotspot. This method also adds a no-op\n   * event lister to the first child of the body that is a parent of this module.\n   * This is due to a bug in iOS where click events do not bubble properly.\n   * The no-op element's tap highlight color is also set to transparent because\n   * it would show the default color on tap because it has a click handler.\n   */\n  _listenForOuterClicks() {\n    this._noopElement.addEventListener('click', this._noop, false);\n    this._noopElement.style.WebkitTapHighlightColor = 'transparent';\n    document.body.addEventListener('click', this._outerClickHandler, false);\n  }\n\n  /**\n   * Remove the delegated click listeners and tap highlight color.\n   */\n  _removeOuterClick() {\n    this._noopElement.removeEventListener('click', this._noop, false);\n    this._noopElement.style.WebkitTapHighlightColor = '';\n    document.body.removeEventListener('click', this._outerClickHandler, false);\n  }\n\n  /**\n   * Listener for clicks on the button inside the hotspot and toggles the hotspot's state.\n   * @param {Event} evt Click event object.\n   */\n  _handleHotspotClick(evt) {\n    evt.preventDefault();\n    const hotspot = this._getHotspotByWrapper(evt.currentTarget.parentElement);\n    this.toggleHotspot(hotspot);\n  }\n\n  /**\n   * When a hotspot is open, this handler is active. If the user clicks outside\n   * the hotspot, it will be closed.\n   * @param {Event} evt Click event object.\n   */\n  _handleOuterClick(evt) {\n    if (!this.getActiveHotspot().content.contains(evt.target)) {\n      this.closeHotspot(this.getActiveHotspot());\n    }\n  }\n\n  /**\n   * When the window size changes, recalculate things.\n   */\n  _handleResize() {\n    this.refresh();\n  }\n\n  /**\n   * Refresh when the page has finished loading. There are likely images within\n   * the hotspot content which may now have a width/height which affects the\n   * size of the hotspot content.\n   */\n  _handleLoad() {\n    window.removeEventListener('load', this._loadHandler, false);\n    this.refresh();\n  }\n\n  /**\n   * Returns the currently open hotspot or null if none are open.\n   * @return {?Hotspot}\n   */\n  getActiveHotspot() {\n    return this._activeHotspot;\n  }\n\n  /**\n   * Update the active hotspot property.\n   * @param {Hotspot} hotspot\n   */\n  setActiveHotspot(hotspot) {\n    this._activeHotspot = hotspot;\n  }\n\n  /**\n   * Recalculates offsets and sizes.\n   */\n  refresh() {\n    this.size = this._getContainerSize();\n    this.hotspots.forEach((hotspot) => {\n      hotspot.refresh();\n    });\n  }\n\n  /**\n   * Remove event listeners and DOM references.\n   */\n  dispose() {\n    this.closeAllHotspots();\n\n    this.hotspots.forEach((hotspot) => {\n      hotspot.button.removeEventListener('click', this._clickHandler, false);\n      hotspot.dispose();\n    });\n\n    this.hotspots = null;\n\n    window.removeEventListener('load', this._loadHandler, false);\n    window.removeEventListener('resize', this._resizeHandler, false);\n\n    this.element.classList.remove(Hotspots.ClassName.LOADED);\n\n    this.element = null;\n    this._activeHotspot = null;\n    this._noopElement = null;\n  }\n}\n\nObject.assign(Hotspots, settings);\n\nexport default Hotspots;\n"],"names":["debounce","func","wait","immediate","timeout","args","context","timestamp","result","later","last","Date","now","setTimeout","apply","debounced","arguments","callNow","clear","count","setUniqueId","element","id","Hotspot","parent","isOpen","wrapper","button","querySelector","settings","ClassName","BUTTON","content","CONTENT","percentPosition","parseWrapperPosition","size","getContentSize","side","getSide","anchor","getAnchor","position","getWrapperPosition","positions","getAttribute","split","parseFloat","offsetWidth","offsetHeight","classList","contains","HOTSPOT_LEFT","HOTSPOT_RIGHT","HOTSPOT_TOP","HOTSPOT_BOTTOM","refresh","refreshId","requestAnimationFrame","_removeContentPosition","setPosition","_setWrapperPosition","style","left","x","top","y","Math","round","width","height","_getOptimalSide","fitsRight","right","fitsLeft","_getOptimalAnchor","fitsTop","bottom","fitsBottom","_setContentPosition","add","remove","show","OPEN","setAttribute","hide","removeAttribute","setA11yAttributes","_removeA11yAttributes","dispose","Hotspots","el","_getContainerSize","hotspots","_getHotspots","_noopElement","_getFirstBodyDescendant","_noop","_activeHotspot","_bindEvents","forEach","hotspot","LOADED","dispatchEvent","EventType","INITIALIZED","getElementsByClass","className","Array","from","querySelectorAll","parentElement","document","body","HOTSPOT","map","_getHotspotByWrapper","i","len","length","eventName","event","defaultPrevented","emit","_clickHandler","_handleHotspotClick","bind","_resizeHandler","_handleResize","_loadHandler","_handleLoad","_outerClickHandler","_handleOuterClick","addEventListener","closeAllHotspots","closeHotspot","toggleHotspot","openHotspot","WILL_OPEN","setActiveHotspot","_listenForOuterClicks","WILL_CLOSE","_removeOuterClick","WebkitTapHighlightColor","removeEventListener","evt","preventDefault","currentTarget","getActiveHotspot","target","TinyEmitter","Object","assign"],"mappings":"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"}