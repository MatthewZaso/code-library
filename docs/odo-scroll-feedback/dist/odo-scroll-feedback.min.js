!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("tiny-emitter")):"function"==typeof define&&define.amd?define(["tiny-emitter"],t):e.OdoScrollFeedback=t(e.TinyEmitter)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},i=!1;try{window.addEventListener("test",null,{get passive(){i=!0}})}catch(e){}var o={SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,UP:38,DOWN:40},s=function(e){function i(o,s){t(this,i);var r=n(this,e.call(this));return r.element=o,r.options=Object.assign({},i.Defaults,s),r._listenerOptions=!!i.PASSIVE_LISTENERS&&{passive:!1},r.canScroll=!0,r._isUserPaused=!1,r.wheelTimeout=null,r.scrollTimeout=null,r.wheelAmount={x:0,y:0},r.startPosition={x:0,y:0},r._handleWheel=r._handleWheel.bind(r),r._handleKeydown=r._handleKeydown.bind(r),r._handleTouchStart=r._handleTouchStart.bind(r),r._handleTouchMove=r._handleTouchMove.bind(r),r._resume=r._resume.bind(r),r._handleScrollTimerExpired=r._handleScrollTimerExpired.bind(r),r._handleScrollEnd=r._handleScrollEnd.bind(r),r.enable(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e),i.prototype.enable=function(){this.element.addEventListener("wheel",this._handleWheel,this._listenerOptions),this.element.addEventListener("mousewheel",this._handleWheel,this._listenerOptions),document.addEventListener("keydown",this._handleKeydown,this._listenerOptions),document.body.addEventListener("touchstart",this._handleTouchStart,this._listenerOptions),document.body.addEventListener("touchmove",this._handleTouchMove,this._listenerOptions),document.body.addEventListener("touchend",this._resume,this._listenerOptions)},i.prototype.disable=function(){this.element.removeEventListener("wheel",this._handleWheel,this._listenerOptions),this.element.removeEventListener("mousewheel",this._handleWheel,this._listenerOptions),document.removeEventListener("keydown",this._handleKeydown,this._listenerOptions),document.body.removeEventListener("touchstart",this._handleTouchStart,this._listenerOptions),document.body.removeEventListener("touchmove",this._handleTouchMove,this._listenerOptions),document.body.removeEventListener("touchend",this._resume,this._listenerOptions)},i.prototype._handleWheel=function(e){if(!this._shouldIgnoreEvent(e.target)){this.canScroll&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(this._handleScrollTimerExpired,this.options.scrollTimerDelay),this._intentToNavigate(this.wheelAmount)&&(this._triggerNavigation(this.wheelAmount),this._pause())),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(this._handleScrollEnd,this.options.scrollEndDelay);var t=this._getWheelDelta(e),n=t.x,i=t.y;0===i&&Math.abs(n)>0||(e.preventDefault(),e.stopPropagation()),this.wheelAmount.x+=n,this.wheelAmount.y+=i}},i.prototype._intentToNavigate=function(e){var t=Math.abs(e.y),n=Math.abs(e.x);return t>this.options.movementThreshold&&t>n},i.prototype._triggerNavigation=function(e){var t=e.y<0?i.Direction.NEXT:i.Direction.PREVIOUS;this.navigate(t)},i.prototype._handleScrollEnd=function(){clearTimeout(this.scrollTimeout),this.wheelTimeout=null,this._resume(),this.emit(i.Events.SCROLL_END),this.wheelAmount={x:0,y:0}},i.prototype._handleScrollTimerExpired=function(){clearTimeout(this.wheelTimeout),this._handleScrollEnd()},i.prototype._handleKeydown=function(e){var t=null;switch(e.which){case o.UP:case o.PAGE_UP:t=i.Direction.PREVIOUS;break;case o.DOWN:case o.PAGE_DOWN:t=i.Direction.NEXT;break;case o.SPACE:t=e.shiftKey?i.Direction.PREVIOUS:i.Direction.NEXT;break;case o.HOME:t=i.Direction.START;break;case o.END:t=i.Direction.END}t&&(e.preventDefault(),e.stopPropagation(),this.canScroll&&this.navigate(t))},i.prototype._handleTouchStart=function(e){this.startPosition={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}},i.prototype._handleTouchMove=function(e){if(!this._shouldIgnoreEvent(e.target))if(this.canScroll){var t={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY},n={x:t.x-this.startPosition.x,y:t.y-this.startPosition.y};this._intentToNavigate(n)&&(e.preventDefault(),this._triggerNavigation(n),this._pause())}else e.preventDefault()},i.prototype._getWheelDelta=function(e){var t=void 0,n=void 0;return"deltaX"in e?1===e.deltaMode?(t=-e.deltaX*i.MOUSE_WHEEL_SPEED,n=-e.deltaY*i.MOUSE_WHEEL_SPEED):(t=-e.deltaX,n=-e.deltaY):"wheelDeltaX"in e&&(t=e.wheelDeltaX/120*i.MOUSE_WHEEL_SPEED,n=e.wheelDeltaY/120*i.MOUSE_WHEEL_SPEED),{x:t,y:n}},i.prototype._shouldIgnoreEvent=function(e){return!!this.options.ignore&&null!==e.closest(this.options.ignore)},i.prototype.navigate=function(e){this.emit(i.Events.NAVIGATE,{direction:e})},i.prototype._pause=function(){this.canScroll=!1},i.prototype._resume=function(){this._isUserPaused||(this.canScroll=!0)},i.prototype.pause=function(){this._isUserPaused=!0,this._pause()},i.prototype.resume=function(){this._isUserPaused=!1,this._resume()},i.prototype.dispose=function(){clearTimeout(this.scrollTimeout),clearTimeout(this.wheelTimeout),this.disable(),this.element=null},i}(e);return s.Events={NAVIGATE:"odoscrollfeedback:navigate",SCROLL_END:"odoscrollfeedback:scrollend"},s.Direction={START:1,PREVIOUS:2,NEXT:3,END:4},s.Defaults={ignore:null,movementThreshold:5,scrollEndDelay:350,scrollTimerDelay:2e3},s.MOUSE_WHEEL_SPEED=20,s.PASSIVE_LISTENERS=i,s});
//# sourceMappingURL=odo-scroll-feedback.min.js.map
