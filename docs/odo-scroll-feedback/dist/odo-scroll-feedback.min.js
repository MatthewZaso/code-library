!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("tiny-emitter")):"function"==typeof define&&define.amd?define(["tiny-emitter"],t):e.OdoScrollFeedback=t(e.TinyEmitter)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},o=!1;try{window.addEventListener("test",null,{get passive(){o=!0}})}catch(e){}var s={SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,UP:38,DOWN:40},r=function(e){function o(n,s){t(this,o);var r=i(this,e.call(this));return r.element=n,r.options=Object.assign({},o.Defaults,s),r._listenerOptions=!!o.PASSIVE_LISTENERS&&{passive:!1},r.canScroll=!0,r._isUserPaused=!1,r.wheelTimeout=null,r.scrollTimeout=null,r.wheelAmount={x:0,y:0},r.startPosition={x:0,y:0},r._handleWheel=r._handleWheel.bind(r),r._handleKeydown=r._handleKeydown.bind(r),r._handleTouchStart=r._handleTouchStart.bind(r),r._handleTouchMove=r._handleTouchMove.bind(r),r._resume=r._resume.bind(r),r._handleScrollTimerExpired=r._handleScrollTimerExpired.bind(r),r._handleScrollEnd=r._handleScrollEnd.bind(r),r.enable(),r}return n(o,e),o.prototype.enable=function(){this.element.addEventListener("wheel",this._handleWheel,this._listenerOptions),this.element.addEventListener("mousewheel",this._handleWheel,this._listenerOptions),document.addEventListener("keydown",this._handleKeydown,this._listenerOptions),document.body.addEventListener("touchstart",this._handleTouchStart,this._listenerOptions),document.body.addEventListener("touchmove",this._handleTouchMove,this._listenerOptions),document.body.addEventListener("touchend",this._resume,this._listenerOptions)},o.prototype.disable=function(){this.element.removeEventListener("wheel",this._handleWheel,this._listenerOptions),this.element.removeEventListener("mousewheel",this._handleWheel,this._listenerOptions),document.removeEventListener("keydown",this._handleKeydown,this._listenerOptions),document.body.removeEventListener("touchstart",this._handleTouchStart,this._listenerOptions),document.body.removeEventListener("touchmove",this._touchmoveHandler,this._listenerOptions),document.body.removeEventListener("touchend",this._resume,this._listenerOptions)},o.prototype._handleWheel=function(e){if(!this._shouldIgnoreEvent(e.target)){this.canScroll&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(this._handleScrollTimerExpired,this.options.scrollTimerDelay),this._intentToNavigate(this.wheelAmount)&&(this._triggerNavigation(this.wheelAmount),this._pause())),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(this._handleScrollEnd,this.options.scrollEndDelay);var t=this._getWheelDelta(e),n=t.x,i=t.y;0===i&&Math.abs(n)>0||(e.preventDefault(),e.stopPropagation()),this.wheelAmount.x+=n,this.wheelAmount.y+=i}},o.prototype._intentToNavigate=function(e){var t=Math.abs(e.y),n=Math.abs(e.x);return t>this.options.movementThreshold&&t>n},o.prototype._triggerNavigation=function(e){var t=e.y<0?o.Direction.NEXT:o.Direction.PREVIOUS;this.navigate(t)},o.prototype._handleScrollEnd=function(){clearTimeout(this.scrollTimeout),this.wheelTimeout=null,this._resume(),this.emit(o.Events.SCROLL_END),this.wheelAmount={x:0,y:0}},o.prototype._handleScrollTimerExpired=function(){clearTimeout(this.wheelTimeout),this._handleScrollEnd()},o.prototype._handleKeydown=function(e){var t=null;switch(e.which){case s.UP:case s.PAGE_UP:t=o.Direction.PREVIOUS;break;case s.DOWN:case s.PAGE_DOWN:t=o.Direction.NEXT;break;case s.SPACE:t=e.shiftKey?o.Direction.PREVIOUS:o.Direction.NEXT;break;case s.HOME:t=o.Direction.START;break;case s.END:t=o.Direction.END}t&&(e.preventDefault(),e.stopPropagation(),this.canScroll&&this.navigate(t))},o.prototype._handleTouchStart=function(e){this.startPosition={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}},o.prototype._handleTouchMove=function(e){if(!this._shouldIgnoreEvent(e.target))if(this.canScroll){var t={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY},n={x:t.x-this.startPosition.x,y:t.y-this.startPosition.y};this._intentToNavigate(n)&&(e.preventDefault(),this._triggerNavigation(n),this._pause())}else e.preventDefault()},o.prototype._getWheelDelta=function(e){var t=void 0,n=void 0;return"deltaX"in e?1===e.deltaMode?(t=-e.deltaX*o.MOUSE_WHEEL_SPEED,n=-e.deltaY*o.MOUSE_WHEEL_SPEED):(t=-e.deltaX,n=-e.deltaY):"wheelDeltaX"in e&&(t=e.wheelDeltaX/120*o.MOUSE_WHEEL_SPEED,n=e.wheelDeltaY/120*o.MOUSE_WHEEL_SPEED),{x:t,y:n}},o.prototype._shouldIgnoreEvent=function(e){return!!this.options.ignore&&null!==e.closest(this.options.ignore)},o.prototype.navigate=function(e){this.emit(o.Events.NAVIGATE,{direction:e})},o.prototype._pause=function(){this.canScroll=!1},o.prototype._resume=function(){this._isUserPaused||(this.canScroll=!0)},o.prototype.pause=function(){this._isUserPaused=!0,this._pause()},o.prototype.resume=function(){this._isUserPaused=!1,this._resume()},o.prototype.dispose=function(){clearTimeout(this.scrollTimeout),clearTimeout(this.wheelTimeout),this.disable(),this.element=null},o}(e);return r.Events={NAVIGATE:"odoscrollfeedback:navigate",SCROLL_END:"odoscrollfeedback:scrollend"},r.Direction={START:1,PREVIOUS:2,NEXT:3,END:4},r.Defaults={ignore:null,movementThreshold:5,scrollEndDelay:350,scrollTimerDelay:2e3},r.MOUSE_WHEEL_SPEED=20,r.PASSIVE_LISTENERS=o,r});
//# sourceMappingURL=odo-scroll-feedback.min.js.map
