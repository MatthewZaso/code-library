!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@odopod/odo-window-events"),require("@odopod/odo-scroll-animation")):"function"==typeof define&&define.amd?define(["@odopod/odo-window-events","@odopod/odo-scroll-animation"],e):t.OdoStickyHeaders=e(t.OdoWindowEvents,t.OdoScrollAnimation)}(this,function(t,e){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e;var s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}();function o(t,e){Object.keys(e).forEach(function(s){t.style[s]=e[s]})}var n=function(){function t(e){s(this,t),this.element=e,this.isFixed=!1,this.isAtBottom=!1,this.isPromoted=!1,this._wrapStickyElement(),this.update()}return t.prototype._wrapStickyElement=function(){this.wrapper=document.createElement("div"),this.wrapper.className=t.Classes.WRAPPER,this.element.parentNode.insertBefore(this.wrapper,this.element),o(this.element,{position:t.INITIAL_POSITION,zIndex:1,top:0,left:0,width:"100%",overflow:"hidden"}),this.element.classList.add(t.Classes.IS_AT_TOP),this.wrapper.appendChild(this.element)},t.prototype._unwrapStickyElement=function(){var t=this.wrapper.parentNode;t.appendChild(this.element),t.removeChild(this.wrapper)},t.prototype.update=function(){var t=this.element.getBoundingClientRect();this.top=t.top+window.pageYOffset,this.height=Math.round(t.height)},t.prototype.stick=function(e,s){this.wrapper.style.height=this.height+"px",this.element.style.position="fixed",this.element.style.top=e+"px",this.element.classList.add(t.Classes.IS_FIXED),this.element.classList.remove(t.Classes.IS_AT_BOTTOM),this.element.classList.remove(t.Classes.IS_AT_TOP),s&&s.appendChild(this.element),this.isAtBottom=!1,this.isFixed=!0},t.prototype.unstick=function(){this.wrapper.style.height="",this.element.style.position=t.INITIAL_POSITION,this.element.style.top="",this.element.classList.add(t.Classes.IS_AT_TOP),this.element.classList.remove(t.Classes.IS_FIXED),this.element.classList.remove(t.Classes.IS_AT_BOTTOM),this.element.parentNode!==this.wrapper&&this.wrapper.appendChild(this.element),this.isFixed=!1,this.isAtBottom=!1},t.prototype.stickToBottom=function(e){this.element.style.position="absolute",this.element.style.top=e+"px",this.element.classList.add(t.Classes.IS_AT_BOTTOM),this.element.classList.remove(t.Classes.IS_FIXED),this.element.classList.remove(t.Classes.IS_AT_TOP),document.body.appendChild(this.element),this.isFixed=!1,this.isAtBottom=!0},t.prototype.layerPromote=function(){this.element.style.willChange="position",this.element.style.transform="translateZ(0)",this.isPromoted=!0},t.prototype.layerDemote=function(){this.element.style.willChange="",this.element.style.transform="",this.isPromoted=!1},t.prototype.dispose=function(){this.unstick(),this._unwrapStickyElement(),o(this.element,{position:"",zIndex:"",top:"",left:"",width:"",overflow:"",willChange:"",transform:""}),this.element=null,this.wrapper=null},t}();function r(t){return t&&1===t.nodeType}n.INITIAL_POSITION="relative",n.Classes={BASE:"odo-sticky-headers__item",WRAPPER:"odo-sticky-headers__item-wrapper",IS_FIXED:"is-fixed",IS_AT_TOP:"is-at-top",IS_AT_BOTTOM:"is-at-bottom"};var h=function(){function o(){s(this,o),this.items=new Map,this._orderedItems=[],this._scrollId=null,this._resizeId=null,this._overlap=0,this._startingOffset=0,this._holder=null,this._getUiOverlap=function(){return 0},this._getUiOffset=this._getUiOverlap,this._mode=o.Mode.PUSH}return o.prototype.add=function(s){var i=this;return(Array.isArray(s)?s:[s]).forEach(function(t){if(!r(t))throw new TypeError('StickyHeaders requires an element. Got: "'+t+'"');i.items.has(t)||i.items.set(t,new n(t))}),this._scrollId?this._cacheItemValues():(this._resizeId=t.onResize(this.update.bind(this)),this._scrollId=e.add(this.process.bind(this)),this._cacheStyles()),this.process(),s},o.prototype.remove=function(s){this.items.has(s)&&(this.items.get(s).dispose(),this.items.delete(s),0===this.items.size&&(e.remove(this._scrollId),t.remove(this._resizeId),this._scrollId=null,this._resizeId=null))},o.prototype.process=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.pageYOffset;this.mode===o.Mode.STACK?this._processStack(t):this._processPush(t)},o.prototype._processStack=function(t){var e=this;this._orderedItems.forEach(function(s){var i=e._getStackHeight(),o=t+e._overlap+i;!s.isFixed&&o>=s.top?s.stick(e._startingOffset+i,e._holder):s.isFixed&&o<s.top+s.height&&s.unstick()})},o.prototype._processPush=function(t){var e=this,s=t+this._overlap;this._orderedItems.forEach(function(t){!t.isFixed&&s>=t.top&&s<t.bottom?t.stick(e._startingOffset,e._holder):!t.isAtBottom&&s>=t.bottom?t.stickToBottom(t.bottom):t.isFixed&&s<t.top&&t.unstick(),e._itemPositionCouldChange(t,s)})},o.prototype._sortItemsByOffset=function(){return Array.from(this.items.values()).sort(function(t,e){return t.top-e.top})},o.prototype._getStackHeight=function(){return this._orderedItems.reduce(function(t,e){return e.isFixed?t+e.height:t},0)},o.prototype._itemPositionCouldChange=function(t,e){var s,i,n,r,h=(s=e,i=t.top,n=t.bottom,r=o.PROMOTION_RANGE,s>=i-r&&s<=n+r);!t.isPromoted&&h?t.layerPromote():t.isPromoted&&!h&&t.layerDemote()},o.prototype._cacheStyles=function(){this._overlap=this._getUiOverlap(),this._startingOffset=this._getUiOffset(),this._cacheItemValues()},o.prototype._cacheItemValues=function(){this._orderedItems=this._sortItemsByOffset(),this.mode===o.Mode.PUSH&&this._saveBottomPositionForItems()},o.prototype._saveBottomPositionForItems=function(){this._orderedItems.forEach(function(t,e,s){var i=s[e+1];t.bottom=i&&i.top-t.height||o.LAST_ITEM_BOTTOM})},o.prototype.update=function(){this.items.forEach(function(t){t.unstick()}),this.items.forEach(function(t){t.update()}),this._cacheStyles(),this.process()},o.prototype.dispose=function(){var t=this;this.items.forEach(function(e,s){t.remove(s)}),this._orderedItems.length=0},i(o,[{key:"uiOverlap",get:function(){return this._getUiOverlap},set:function(t){this._getUiOverlap=t,this.update()}},{key:"uiOffset",get:function(){return this._getUiOffset},set:function(t){this._getUiOffset=t}},{key:"stickyHolder",get:function(){return this._holder},set:function(t){this._holder=r(t)?t:null}},{key:"mode",get:function(){return this._mode},set:function(t){this._mode=t}}]),o}();return h.PROMOTION_RANGE=200,h.LAST_ITEM_BOTTOM=1/0,h.Mode={PUSH:1,STACK:2},h.StickyItem=n,h});
//# sourceMappingURL=odo-sticky-headers.min.js.map
