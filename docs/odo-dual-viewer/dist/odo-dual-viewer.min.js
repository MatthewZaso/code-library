!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("tiny-emitter"),require("@odopod/odo-helpers"),require("@odopod/odo-draggable"),require("@odopod/odo-window-events"),require("@odopod/odo-object-fit")):"function"==typeof define&&define.amd?define(["tiny-emitter","@odopod/odo-helpers","@odopod/odo-draggable","@odopod/odo-window-events","@odopod/odo-object-fit"],e):t.OdoDualViewer=e(t.TinyEmitter,t.OdoHelpers,t.OdoDraggable,t.OdoWindowEvents,t.OdoObjectFit)}(this,function(t,e,i,s,o){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,i=i&&i.hasOwnProperty("default")?i.default:i,s=s&&s.hasOwnProperty("default")?s.default:s,o=o&&o.hasOwnProperty("default")?o.default:o;var n={Position:{START:0,CENTER:1,END:2,BETWEEN:3},ClassName:{VERTICAL:"odo-dual-viewer--vertical",INNER:"odo-dual-viewer__inner",SCRUBBER_CONTAINER:"odo-dual-viewer__scrubber-bounds",SCRUBBER:"odo-dual-viewer__scrubber",OVERLAY:"odo-dual-viewer__overlay",UNDERLAY:"odo-dual-viewer__underlay",MEDIA:"odo-dual-viewer__media",GRABBING:"grabbing",CENTERED:"is-centered",START:"is-start",END:"is-end"},EventType:{CAME_TO_REST:"ododualviewer:handlecametorest"},Defaults:{startPosition:.5,isVertical:!1,animationDuration:300,verticalSafeZone:.1,hasZones:!0,zones:[.33,.33,.66,.66]}},r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},h=function(t){function n(e,i){r(this,n);var s=l(this,t.call(this));return s.element=e,s.options=Object.assign({},n.Defaults,i),s._isVertical=s.options.isVertical,s._scrubberEl=null,s._overlayEl=null,s._underlayEl=null,s._overlayObjectEl=null,s._draggable=null,s._scrubberLimits=null,s._dragAxis=s._isVertical?"y":"x",s._dimensionAttr=s._isVertical?"height":"width",s._previousPercent=s.options.startPosition,s._position=n.Position.CENTER,s._isResting=!0,s.decorate(),s}return a(n,t),n.prototype.getElementByClass=function(t){return this.element.querySelector("."+t)},n.prototype.getElementsByClass=function(t){return this.element.querySelectorAll("."+t)},n.prototype.decorate=function(){this._scrubberEl=this.getElementByClass(n.ClassName.SCRUBBER),this._overlayEl=this.getElementByClass(n.ClassName.OVERLAY),this._underlayEl=this.getElementByClass(n.ClassName.UNDERLAY),this._overlayObjectEl=this._overlayEl.firstElementChild,this._draggable=new i(this._scrubberEl,{axis:this._dragAxis}),this.element.classList.toggle(n.ClassName.VERTICAL,this._isVertical),this.element.classList.add(n.ClassName.CENTERED),this._setupHandlers(),this._saveContainerSize(),this._saveScrubberLimits(),o.cover(this.getElementsByClass(n.ClassName.MEDIA)),this._draggable.setLimits(this._scrubberLimits),this.setPosition(this.options.startPosition)},n.prototype._setupHandlers=function(){this._resizeId=s.onResize(this.reset.bind(this)),this._onMove=this._handleDragMove.bind(this),this._onEnd=this._handleDragEnd.bind(this),this._draggable.on(i.EventType.MOVE,this._onMove),this._draggable.on(i.EventType.END,this._onEnd)},n.prototype._saveScrubberLimits=function(){var t=void 0;if(this._isVertical){var i=this._containerHeight*this.options.verticalSafeZone,s=this._containerHeight*(1-2*this.options.verticalSafeZone);t=new e.math.Rect(0,i,this._containerWidth,s)}else{var o=this.getElementByClass(n.ClassName.SCRUBBER_CONTAINER),r=this.element.getBoundingClientRect(),a=o.getBoundingClientRect();t=new e.math.Rect(Math.round(a.left-r.left),o.offsetTop,o.offsetWidth,this._containerHeight)}this._scrubberLimits=t},n.prototype.getPosition=function(){return this._position},n.prototype.setPosition=function(t){this._draggable.setPosition(100*t,100*t),this._reveal(t)},n.prototype._getLimitedPercent=function(t){var i=this._scrubberLimits,s=void 0,o=void 0;return this._isVertical?(s=i.top/this._containerHeight,o=(i.top+i.height)/this._containerHeight):(s=i.left/this._containerWidth,o=(i.left+i.width)/this._containerWidth),e.math.clamp(t,s,o)},n.prototype._saveContainerSize=function(){this._containerWidth=this.element.offsetWidth,this._containerHeight=this.element.offsetHeight},n.prototype._removeStateClasses=function(){this.element.classList.remove(n.ClassName.START,n.ClassName.END,n.ClassName.CENTERED),this._isResting=!1},n.prototype._reveal=function(t){this._overlayEl.style[this._dimensionAttr]=100*t+"%",this._overlayObjectEl.style[this._dimensionAttr]=100/t+"%"},n.prototype.reset=function(){this._saveContainerSize(),this._saveScrubberLimits(),o.cover(this.getElementsByClass(n.ClassName.MEDIA)),this._draggable.setLimits(this._scrubberLimits);var t=100*this._previousPercent;this._draggable.setPosition(t,t),this._reveal(this._getLimitedPercent(this._previousPercent))},n.prototype._handleDragMove=function(t){this._isResting&&(this._removeStateClasses(),this._position=n.Position.BETWEEN);var e=t.position.percent[this._dragAxis]/100;this._previousPercent=e,this._reveal(e)},n.prototype._handleDragEnd=function(t){if(this.options.hasZones){var e=t.position.percent[this._dragAxis]/100;this._position=this._getZone(e);var i=null;switch(this._position){case n.Position.START:i=0;break;case n.Position.CENTER:i=.5;break;case n.Position.END:i=1}null!==i&&this.animateTo(i)}},n.prototype._getZone=function(t){return t>0&&t<this.options.zones[0]?n.Position.START:t<1&&t>this.options.zones[3]?n.Position.END:t>=this.options.zones[1]&&t<=this.options.zones[2]?n.Position.CENTER:n.Position.BETWEEN},n.prototype.animateTo=function(t){var i=this._getLimitedPercent(t);i!==this._previousPercent&&(this._position=this._getZone(i),this._removeStateClasses(),new e.animation.Stepper({start:this._previousPercent,end:i,duration:this.options.animationDuration,step:this._animateStep,context:this}).onfinish=this._didComeToRest)},n.prototype._animateStep=function(t){this._draggable.setPosition(100*t,100*t),this._reveal(t)},n.prototype._didComeToRest=function(){this._previousPercent=this._draggable.getPosition(!0)[this._dragAxis]/100,this._isResting=!0,this.element.classList.toggle(n.ClassName.START,this._position===n.Position.START),this.element.classList.toggle(n.ClassName.END,this._position===n.Position.END),this.element.classList.toggle(n.ClassName.CENTERED,this._position===n.Position.CENTER),this.emit(n.EventType.CAME_TO_REST,{position:this.getPosition()})},n.prototype.dispose=function(){s.remove(this._resizeId),this._draggable.off(i.EventType.MOVE,this._onMove),this._draggable.off(i.EventType.END,this._onEnd),this._draggable.dispose(),this.element.classList.remove(n.ClassName.CENTERED,n.ClassName.VERTICAL),this.element=null,this._scrubberEl=null,this._overlayObjectEl=null,this._overlayEl=null,this._underlayEl=null},n}(t);return Object.assign(h,n),h});
//# sourceMappingURL=odo-dual-viewer.min.js.map
